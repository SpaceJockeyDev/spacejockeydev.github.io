<!DOCTYPE html>
<head>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3TG9FQV72R"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3TG9FQV72R');
</script>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link
    rel="stylesheet"
    href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
  />
  <link rel="stylesheet" type="text/css" href="styles.css" />
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
  />
  <link rel="icon" href="assets/fist.ico" />
  <style>
    .ticket-link {
        display: block;
        color: red;
      }
      .ticket-link:hover {
        color: red;
      }
    .content-container {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: calc(
        100vh - 60px
      ); /* Adjust based on the height of your navbar and footer */
      margin: 0;
    }
    #bands {
  display: flex;
  justify-content: center;
}
#bands ul {
        padding: 0;
        margin: 0;
        margin-bottom: 15px !important;
      }
    #band-name {
      color: #333;
      font-family: "Viva";
      padding-left: 20px;
      padding-right: 20px;
      font-size: 60px;
    }
    .center-container {
      display: flex;
      justify-content: center;
    }
    .band-name-container {
      display: inline-block; /* This makes the div only as wide as its contents */
      background-color: whitesmoke;
      margin-top: 20px;
      margin-bottom: 20px;
    }
    .li-separator:not(:last-child) {
    border-bottom: 2px solid #ccc; 
    padding-bottom: 10px; 
    margin-bottom: 10px; 
    width: 100%; 
    box-sizing: border-box; 
  }
  #bands ul {
    padding: 0;
    margin: 0;
    margin-bottom: 15px !important;
    list-style-type: none; 
    width: 100%; 
  }
  #bands li {
    width: 100%; 
  }
      .band-section {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        background-color: whitesmoke;
        padding-top: 20px;
        text-align: center;
        width: 50%;
        margin: 0 auto;
        margin-bottom: 40px;
      }
    #band-picture {
      width: 600px;
      height: auto;
      display: block; 
      margin-left: auto;
      margin-right: auto;
    }
    #band-bio {
      font-size: 1.2em;
      color: #0f0101;
      font-family: "Alte";
      background-color: whitesmoke;
      padding-left: 20px;
      padding-right: 20px;
    }
    .band-releases {
      display: flex;
      flex-wrap: wrap;
    }
    .highlight {
      background-color: whitesmoke;
      padding: 0 10px;
    }
    .release {
      flex-basis: calc(20% - 15px); /* 5 albums in a row */
      margin-bottom: 20px;
      text-align: center;
      margin-right: 15px;
    }
    .release img {
      width: 250px;
      height: auto;
    }
    .release-name {
      /* Add your styles here */
      font-size: 16px;
      color: #333;
      margin-top: 10px;
      font-family: "Helv";
      background-color: whitesmoke;
    }
    body {
      background-image: url("assets/PNGs/Skyline_Cropped.png"),
        url("assets/PNGs/Hands_Cropped.png"), url("assets/PNGs/Circle_Full.png");
      background-position: right, left, left 120px;
      background-size: 15%, 40%, 20%;
      background-repeat: repeat-y, repeat-y, no-repeat;
      background-attachment: fixed;
      background-color: #f2ead3;
    }
    .band-info {
      display: column;
      margin-left: auto;
      margin-right: auto;
      width: 90%;
    }
    .preserve-whitespace {
    white-space: pre-wrap;
  }
  .center-text {
  text-align: center;
}
.no-events {
  background-color: white; 
  padding: 10px; 
  font-family: Alte;
  font-size: 16px;
  margin-bottom: 40px;
}
    @media (max-width: 990px) {
      #band-picture {
        width: 400px;
        max-width: 100%;
        display: block;
        margin: auto;
      }
      #band-name {
        text-align: center;
        font-size: 40px;
      }
      .band-section{
        width: 100%;
      }
      .release img {
        width: 200px;
        height: auto;
      }
      body::before {
        content: "";
        position: fixed;
        z-index: -1;
        top: 0;
        left: 0;
        background-image: url("assets/PNGs/Skyline_Full.png"),
          url("assets/PNGs/Hands_Cropped.png"),
          url("assets/PNGs/Circle_Full.png");
        background-position: right, left, left 120px;
        background-size: 15%, 50%, 60%;
        background-repeat: repeat-y, repeat-y, no-repeat;
        background-color: #f2ead3;
        min-width: 100%;
        min-height: 100%;
      }
      .band-info {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }
      .band-releases {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }
      .bio-container {
        width: 100%;
        max-width: 400px; /* You can adjust this value to your liking */
      }
    }
    #band-releases .release a:hover {
      text-decoration: none;
    }
    #band-hometown {
      font-family: "Helv"; /* Replace with your desired font */
      text-align: center;
      background-color: whitesmoke;
    }
    #band-socials {
      text-align: center; /* Center the band socials */
      background-color: whitesmoke;
    }
    .info-container {
      display: inline-block;
      background-color: whitesmoke;
      text-align: center;
      padding-left: 20px;
      padding-right: 20px;
      margin-top: 10px;
      margin-bottom: 20px;
    }
    .info-wrapper {
      display: flex;
      justify-content: center;
    }
  </style>
</head>
<body>
  <nav id="navbar-container"></nav>
  <main id="content-container">
    <div class="center-container">
      <div class="band-name-container">
        <h1 id="band-name"></h1>
      </div>
    </div>
    <img id="band-picture" />
    <div class="info-wrapper">
      <div class="info-container">
        <p id="band-hometown"></p>
        <p id="band-socials"></p>
      </div>
    </div>
    <div class="band-info">
      <div class="bio-container">
        <p id="band-bio"></p>
      </div>
      <h2 class="center-text" style="font-family: 'Viva'">
        <span class="highlight">Releases</span>
      </h2>
      <div id="band-releases" class="band-releases"></div>
      <h2 class="center-text" style="font-family: 'Viva'">
        <span class="highlight">Tour Dates</span>
      </h2>
    <div
      id="loading"
      style="
        display: flex;
        justify-content: center;
        flex-direction: column;
        align-items: center;
        margin-bottom: 40px;
      "
    >
      <i class="fas fa-spinner fa-spin" style="font-size: 4rem"></i>
    </div>
    <div id="bands"></div>
  </div>
  </main>
  <footer id="footer"></div>
</body>
<script>
  const urlParams = new URLSearchParams(window.location.search);
  const bandName = decodeURIComponent(urlParams.get("band")).replace(/-/g, " ");

  fetch("bands.json")
    .then((response) => response.json())
    .then((bands) => {
  const band = bands.find((band) => band.bandName === bandName);

  if (!band) {
    // Band not found: show error message and stop further processing
    document.getElementById("band-name").innerHTML = `<span class="underline">Band Not Found</span>`;
    document.getElementById("band-picture").style.display = "none";
    document.getElementById("band-hometown").textContent = "";
    document.getElementById("band-bio").innerHTML = "<span style='color:red;'>Sorry, we couldn't find that band. Check the URL.</span>";
    document.getElementById("band-socials").innerHTML = "";
    document.getElementById("band-releases").innerHTML = "";
    document.title = "Red Scare | Band Not Found";
    return; // Stop further processing
  }

      fetch("releases.json")
        .then((response) => response.json())
        .then((releases) => {
          // Filter the releases that include the band's name in bandName or songTitles
          band.releases = releases.filter((release) =>
            release.bandName.includes(band.bandName) ||
            release.trackList.some((trackList) => trackList.includes(band.bandName))
          );

          // Sort the releases by release number
          band.releases.sort((a, b) => b.releaseNumber - a.releaseNumber);

          document.getElementById(
            "band-name"
          ).innerHTML = `<span class="underline">${band.bandName}</span>`;
          document.getElementById("band-picture").src = band.picture;
          document.getElementById("band-hometown").textContent =
            "Hometown: " + band.hometown;
          document.getElementById("band-bio").style.whiteSpace = "pre-wrap";
          document.getElementById("band-bio").innerHTML = band.bio;
          document.getElementById("band-socials").innerHTML = `
            ${
              band.socials.facebook
                ? `<a href="${band.socials.facebook}" target="_blank"><i class="fab fa-facebook-f"></i></a>`
                : ""
            }
            ${
              band.socials.twitter
                ? `<a href="${band.socials.twitter}" target="_blank"><i class="fab fa-twitter"></i></a>`
                : ""
            }
            ${
              band.socials.instagram
                ? `<a href="${band.socials.instagram}" target="_blank"><i class="fab fa-instagram"></i></a>`
                : ""
            }
            ${
              band.socials.bandcamp
                ? `<a href="${band.socials.bandcamp}" target="_blank"><i class="fab fa-bandcamp"></i></a>`
                : ""
            }
            ${
              band.socials.website
                ? `<a href="${band.socials.website}" target="_blank"><i class="fas fa-house"></i></a>`
                : ""
            }`;

          document.title = "Red Scare | " + band.bandName;

          band.releases.forEach((release) => {
            const releaseElement = document.createElement("div");
            releaseElement.className = "release";
            const albumLink = encodeURIComponent(
              release.album.replace(/ /g, "-")
            );
            releaseElement.innerHTML = `
            <a href="release-info.html?album=${albumLink}">
                <img src="${release.coverArt}" alt="${release.album} Cover Art">
                            <p class="release-name">${release.displayAlbum}</p>
                        </a>
                    `;
            document
              .getElementById("band-releases")
              .appendChild(releaseElement);
          });

          // Load tour dates after band info is loaded
          loadTourDates(band.bandName);
        })
        .catch((error) => console.error("Error:", error));
    })
    .catch((error) => console.error("Error:", error));

  // Function to decode HTML entities
  function decodeHtmlEntities(text) {
    const textArea = document.createElement('textarea');
    textArea.innerHTML = text;
    return textArea.value;
  }

  // Function to load tour dates
  async function loadTourDates(currentBandName) {
    try {
      const showsData = await fetch("shows.json").then(response => response.json());
      const bandsDiv = document.getElementById("bands");

      const today = new Date();
      today.setHours(0, 0, 0, 0);

      // Filter shows data for the current band and future events
      const bandEvents = showsData.filter(event => {
        const eventTitle = event.title.toLowerCase();
        const eventDate = new Date(event.start_date);
        return eventTitle.includes(currentBandName.toLowerCase()) && eventDate >= today;
      });

      // Sort events by date (earliest first)
      bandEvents.sort((a, b) => new Date(a.start_date) - new Date(b.start_date));

      const fragment = document.createDocumentFragment();

      if (bandEvents.length > 0) {
        const bandSection = document.createElement("div");
        bandSection.className = "band-section";

        const tourDatesList = document.createElement("ul");
        tourDatesList.style.listStyleType = "none";
        tourDatesList.style.marginBottom = "50px";

        bandEvents.forEach(event => {
          const li = document.createElement("li");
          li.className = "li-separator";
          li.style.backgroundColor = "whitesmoke";
          const eventDate = new Date(event.start_date);
          const formattedDate = eventDate.toLocaleString("en-US", {
            month: "short",
            day: "2-digit",
            year: "numeric",
          });
          
          // Decode HTML entities in venue name
          const decodedVenue = decodeHtmlEntities(event.venue.venue);
          
          if (event.venue.country === "United States") {
            li.textContent = `${formattedDate} - ${event.venue.city}, ${event.venue.stateprovince} - ${decodedVenue}`;
          } else {
            li.textContent = `${formattedDate} - ${event.venue.city}, ${event.venue.country} - ${decodedVenue}`;
          }
          if (event.description) {
            const description = document.createElement("p");
            description.innerHTML = event.description;
            description.style.marginLeft = "0px";
            description.style.fontStyle = "italic";
            li.appendChild(description);
          }
          if (event.website) {
            const a = document.createElement("a");
            a.href = event.website;
            a.textContent = "Buy Tickets";
            a.className = "ticket-link";
            a.target = "_blank";
            li.appendChild(a);
          }
          tourDatesList.appendChild(li);
        });
        bandSection.appendChild(tourDatesList);
        fragment.appendChild(bandSection);
      } else {
        const noEvents = document.createElement("p");
        noEvents.textContent = "No upcoming tour dates.";
        noEvents.classList.add("no-events");
        fragment.appendChild(noEvents);
      }
      
      bandsDiv.appendChild(fragment);

    } catch (error) {
      console.error("Error loading tour dates:", error);
      const noEvents = document.createElement("p");
      noEvents.textContent = "Error loading tour dates.";
      noEvents.classList.add("no-events");
      document.getElementById("bands").appendChild(noEvents);
    }

    const loadingElement = document.getElementById("loading");
    if (loadingElement) {
      loadingElement.style.display = "none";
    }
  }
</script>
<script>
// Step 1: Get the bio text
const bioElement = document.getElementById('band-bio');
if (bioElement) { // Ensure the element exists
  let bioText = bioElement.innerHTML;

  // Step 2 and 3: Replace each period followed by a space with a period followed by two non-breaking spaces
  bioText = bioText.replace(/\. /g, '.&nbsp;&nbsp;');

  // Step 4: Set the modified text back to the element
  bioElement.innerHTML = bioText;
} else {
  console.error('Bio element not found');
}
</script>
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script>
  $(function () {
    $("#navbar-container").load("navigation.html");
  });
</script>
<script>
  $(function () {
    $("#footer").load("footer.html");
  });
</script>
<script>
</script>
  </html>